<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HEP Hub: Post-Rehab Exercise Library and Prescription Platform (Local Storage)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1f2937; /* Very dark gray/deep charcoal for professional dark theme */
            color: #d1d5db; /* Default light text color */
        }
        /* Custom scrollbar for aesthetics */
        body::-webkit-scrollbar {
            width: 8px;
        }
        body::-webkit-scrollbar-thumb {
            background-color: #374151; /* Darker gray for contrast */
            border-radius: 10px;
        }
        
        .card {
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.25); /* Darker shadow for dark background */
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: grab; /* Indicates draggable */
        }
        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 16px 25px rgba(6, 182, 212, 0.4); /* Cyan hover glow on dark background */
        }
        .drag-over {
            border: 3px dashed #06b6d4 !important; /* Cyan dashed border on drag over */
            background-color: #1f3248 !important; /* Slightly lighter dark background */
        }

        /* Color-coding classes using the requested palette */
        .strength-border { border-left: 6px solid #1e3a8a; } /* Navy Blue */
        .stretching-border { border-left: 6px solid #ea580c; } /* Orange */
        .balance-border { border-left: 6px solid #0d9488; } /* Teal */
        .functional-border { border-left: 6px solid #4f46e5; } /* Indigo/Functional Accent */
        .motor-control-border { border-left: 6px solid #15803d; } /* Deep Green */

        /* Styles for the draggable Prescription Pad */
        #hepPad {
            transition: all 0.3s ease;
            max-height: calc(100vh - 140px); /* Set max height for sticky area */
            overflow-y: auto;
        }
        #hepPad::-webkit-scrollbar { width: 4px; }
        #hepPad::-webkit-scrollbar-thumb { background-color: #0d9488; border-radius: 4px; }
        
         /* Custom print styles to hide UI and show the dedicated print content */
        @media print {
            body > *:not(#printView) { /* Hide all direct children of body except the print view */
                display: none !important;
            }
            #printView, #printView * { /* Only show the print view and its contents */
                display: block !important;
            }
            #printView {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                /* Reset colors and margins for printing */
                padding: 0;
                margin: 0;
                background-color: white;
                color: black;
                box-shadow: none;
                border: none;
            }
            /* Ensure the table prints clearly */
            #printView table {
                border-collapse: collapse;
                width: 100%;
            }
            #printView th, #printView td {
                border: 1px solid #999;
                padding: 10px;
                color: black;
                background-color: white;
            }
            #printView th {
                background-color: #e0e7ff; /* Light blue header for professionalism */
                color: #1e3a8a;
            }
            .print-header h1 {
                color: #1e3a8a !important;
            }
        }
    </style>
</head>
<body class="p-0 sm:p-4 md:p-8">

    <button id="jumpToBottom" class="fixed bottom-6 right-6 p-4 bg-orange-500 text-white rounded-full shadow-lg hover:bg-orange-600 transition-all z-50 transform active:scale-95">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14M19 12l-7 7-7-7"/></svg>
    </button>
    
    <div id="messageBox" class="fixed inset-0 bg-gray-900 bg-opacity-75 hidden z-50 flex items-center justify-center">
        <div class="bg-gray-800 p-6 rounded-xl shadow-2xl max-w-sm w-full border-t-4 border-teal-500">
            <h4 id="messageTitle" class="text-xl font-bold text-teal-400 mb-3"></h4>
            <p id="messageBody" class="text-gray-300 mb-4"></p>
            <button id="messageCloseBtn" class="w-full py-2 bg-teal-600 text-white font-semibold rounded-lg hover:bg-teal-700 transition-colors">Close</button>
        </div>
    </div>


    <div class="max-w-7xl mx-auto">
        
        <header class="sticky top-0 z-40 mb-8 p-6 bg-blue-900 text-white rounded-b-2xl shadow-2xl transition-all">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                <div class="text-center md:text-left">
                    <h1 class="text-4xl sm:text-5xl font-extrabold text-white flex items-center justify-center md:justify-start">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 mr-3 text-teal-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>
                        HEP Hub
                    </h1>
                    <p class="text-lg sm:text-xl font-medium text-teal-300 mt-1">
                        Post-Rehab Exercise Library and Prescription Platform
                    </p>
                    <p id="authStatus" class="text-xs text-gray-400 mt-1">
                        Status: Using Local Storage (Saving to your browser)
                    </p>
                </div>
                
                <div class="flex space-x-2 p-2 bg-blue-800 rounded-xl">
                    <button id="viewLibraryBtn" class="px-6 py-2 rounded-lg font-semibold text-lg bg-teal-600 text-white hover:bg-teal-700 transition-colors shadow-lg active-tab-class">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 inline mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                        Exercise Library
                    </button>
                    <button id="viewProgramsBtn" class="px-6 py-2 rounded-lg font-semibold text-lg text-gray-300 hover:bg-blue-700 transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 inline mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                        Saved Programs
                    </button>
                </div>
                
            </div>
        </header>

        <main class="p-4 sm:p-0">

            <div id="libraryView" class="view-content">
                
                <section class="mb-8 p-6 bg-gray-800 rounded-xl shadow-xl border-t-4 border-teal-500">
                    <h2 class="text-2xl font-bold text-teal-400 mb-6 border-b pb-2 border-gray-700">Exercise Color Key (Drag exercises into the HEP Pad on the right)</h2>
                    
                    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-6 text-base font-semibold text-gray-100">
                        <div class="flex items-center p-3 rounded-lg bg-gray-900 hover:shadow-lg transition-shadow">
                            <span class="w-4 h-4 rounded-full mr-3 bg-blue-900"></span>
                            Strength Training
                        </div>
                        <div class="flex items-center p-3 rounded-lg bg-gray-900 hover:shadow-lg transition-shadow">
                            <span class="w-4 h-4 rounded-full mr-3 bg-orange-600"></span>
                            Stretching/Flexibility
                        </div>
                        <div class="flex items-center p-3 rounded-lg bg-gray-900 hover:shadow-lg transition-shadow">
                            <span class="w-4 h-4 rounded-full mr-3 bg-teal-600"></span>
                            Balance/Coordination
                        </div>
                        <div class="flex items-center p-3 rounded-lg bg-gray-900 hover:shadow-lg transition-shadow">
                            <span class="w-4 h-4 rounded-full mr-3 bg-indigo-700"></span>
                            Functional Exercise
                        </div>
                        <div class="flex items-center p-3 rounded-lg bg-gray-900 hover:shadow-lg transition-shadow">
                            <span class="w-4 h-4 rounded-full mr-3 bg-green-800"></span>
                            Motor Control
                        </div>
                    </div>
                </section>

                <div class="grid grid-cols-1 xl:grid-cols-3 gap-8">
                    
                    <section class="xl:col-span-2">
                        <div class="mb-8 relative">
                            <svg xmlns="http://www.w3.org/2000/svg" class="absolute left-4 top-1/2 transform -translate-y-1/2 w-6 h-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                            <input id="searchInput" type="text" placeholder="Search by name, injury (e.g., ACL, Low Back), category, or phase..." 
                                class="w-full pl-12 pr-4 py-4 border-2 border-gray-600 rounded-xl shadow-lg focus:outline-none focus:ring-4 focus:ring-teal-400 transition duration-300 text-lg bg-gray-900 text-gray-100 placeholder-gray-400">
                        </div>

                        <h2 class="text-3xl font-extrabold text-gray-100 mb-6 border-b-2 pb-3 border-teal-500">
                            Exercise Library (<span id="exerciseCount"></span> items)
                        </h2>

                        <div id="resultsContainer" class="w-full grid grid-cols-1 md:grid-cols-2 gap-6">
                            </div>

                        <div id="noResults" class="hidden text-center p-12 bg-gray-800 rounded-xl shadow-lg text-gray-400 mt-10">
                            <p class="text-xl font-semibold">No Exercises Match Your Search.</p>
                            <p class="mt-2">Try a different keyword or check the categories in the Color Key above.</p>
                        </div>
                    </section>

                    <aside class="xl:col-span-1 hidden xl:block">
                        <div id="hepPad" 
                            class="sticky top-32 p-6 bg-gray-800 rounded-xl shadow-2xl border-4 border-dashed border-teal-300 flex flex-col items-center justify-start h-[calc(100vh-140px)]"
                            ondragover="handleDragOver(event)" 
                            ondrop="handleDrop(event)"
                            ondragleave="handleDragLeave(event)">
                            
                            <h3 class="text-2xl font-extrabold text-teal-400 mb-4 border-b pb-2 w-full text-center border-gray-700">
                                Current Prescription
                            </h3>
                            
                            <div id="hepPadContent" class="w-full space-y-4 overflow-y-auto flex-grow">
                                </div>

                            <p id="hepPadEmptyMessage" class="text-gray-400 text-center mt-8 absolute top-1/2 transform -translate-y-1/2">
                                Drag and drop exercises here to build a custom Home Exercise Program.
                            </p>


                            <button id="prescribeButton" class="w-full mt-4 py-3 bg-teal-600 text-white font-semibold rounded-lg shadow-xl hover:bg-teal-700 transition-colors disabled:opacity-50" disabled>
                                Generate and Save HEP (0 Exercises)
                            </button>

                        </div>
                    </aside>
                </div>
            </div>

            <div id="programsView" class="view-content hidden">
                <h2 class="text-3xl font-extrabold text-gray-100 mb-6 border-b-2 pb-3 border-orange-500">
                    Saved Patient Programs
                </h2>
                <div class="p-6 bg-gray-800 rounded-xl shadow-xl border-t-4 border-orange-500 min-h-64">
                    <p class="text-gray-400 mb-4">Your programs are secured locally in this browser. They are not stored in the cloud.</p>
                    
                    <div id="programsLoading" class="text-center p-12 text-gray-400 hidden">
                        Loading patient data...
                    </div>

                    <div id="programsList" class="space-y-4">
                        </div>

                    <div id="programsEmpty" class="hidden text-center p-12 bg-gray-900 rounded-lg text-gray-400 mt-4">
                        <p class="text-xl font-semibold">No Programs Saved Yet.</p>
                        <p class="mt-2">Switch to the Exercise Library to create your first Home Exercise Program.</p>
                    </div>
                </div>
                
                <div id="detailModal" class="fixed inset-0 bg-gray-900 bg-opacity-75 hidden z-50 flex items-center justify-center p-4">
                    <div class="bg-gray-800 p-8 rounded-xl shadow-2xl max-w-2xl w-full border-t-4 border-orange-500 max-h-[90vh] overflow-y-auto">
                        <h4 id="detailPatientName" class="text-2xl font-bold text-orange-400 mb-4 border-b pb-2 border-gray-700"></h4>
                        <div id="detailProgramExercises" class="space-y-3 mb-6">
                            </div>
                        <button id="detailCloseBtn" class="w-full py-2 bg-teal-600 text-white font-semibold rounded-lg hover:bg-teal-700 transition-colors">Close</button>
                    </div>
                </div>
            </div>
        </main>

        <footer id="footer" class="mt-12 p-6 text-center text-gray-400 text-sm bg-gray-800 rounded-xl shadow-inner">
            <p>&copy; 2024 HEP Hub. Specialized Post-Rehab Exercise Platform.</p>
            <p class="mt-2">Data stored locally in your browser using **LocalStorage**.</p>
        </footer>

    </div>

    <script type="text/javascript">
        // --- LOCAL STORAGE DATA FUNCTIONS ---

        // Key for storing data in LocalStorage
        const LOCAL_STORAGE_KEY = 'hepHUB_patient_programs';
        
        // Array to store programs globally
        let patientPrograms = [];
        
        // Array to store selected exercises for the current prescription
        window.selectedExercises = [];
        

        // --- EXERCISE DATA (COMPLETE) ---
        const exercises = [
            // STRENGTH TRAINING (Navy Blue) - 50 Exercises
            { id: 1, name: "Single-Leg Press (Unloaded)", category: "Strength Training", focus: "Quads, Glutes", injury: "Knee (ACL/MCL)", setsReps: "3x15", phase: "Early-Mid Rehab", description: "Controlled eccentric lowering for neuromuscular control and initial strength building." },
            { id: 2, name: "Rotator Cuff Isometric Holds (Subscap)", category: "Strength Training", focus: "Rotator Cuff", injury: "Shoulder Impingement", setsReps: "3x10s", phase: "Acute/Early Rehab", description: "Gentle co-contraction for stability without movement. Press into wall/door frame." },
            { id: 3, name: "Banded Hip Abduction (Clamshell)", category: "Strength Training", focus: "Glute Medius", injury: "Hip, Low Back", setsReps: "3x20", phase: "Mid Rehab", description: "Focus on isolating the lateral hip stabilizers. Avoid pelvic rotation." },
            { id: 4, name: "Prone Scapular Squeeze (Y/T/W)", category: "Strength Training", focus: "Scapular Stabilizers", injury: "Postural Syndrome", setsReps: "3x10", phase: "Mid Rehab", description: "Strengthening mid-back musculature for improved posture and shoulder mechanics." },
            { id: 5, name: "Split Squat (2-inch lift)", category: "Strength Training", focus: "Lower Body", injury: "Ankle Sprain", setsReps: "3x10/leg", phase: "Late Rehab", description: "Increase depth gradually to challenge range of motion and unilateral leg strength." },
            { id: 6, name: "Eccentric Calf Raises (Slow)", category: "Strength Training", focus: "Calves, Achilles", injury: "Achilles Tendinopathy", setsReps: "3x12", phase: "Late Rehab", description: "Focus on a 4-second lowering phase to rebuild tendon tolerance." },
            { id: 7, name: "Lateral Step-Ups (Box)", category: "Strength Training", focus: "Glutes, Quads", injury: "Knee Pain", setsReps: "3x12/leg", phase: "Mid Rehab", description: "Improves hip strength and frontal plane stability." },
            { id: 8, name: "Dumbbell Row (Neutral Grip)", category: "Strength Training", focus: "Upper Back", injury: "Thoracic Outlet Syndrome", setsReps: "3x10", phase: "Mid Rehab", description: "Strengthens back extensors and retractors to relieve shoulder/neck tension." },
            { id: 9, name: "Weighted Glute Bridge (Hold)", category: "Strength Training", focus: "Glutes, Hamstrings", injury: "Sacroiliac Joint Dysfunction", setsReps: "3x12", phase: "Mid Rehab", description: "Maximal glute contraction at the top; avoid hyperextending the low back." },
            { id: 10, name: "Incline Push-ups (Hands on wall)", category: "Strength Training", focus: "Chest, Shoulders", injury: "Wrist Fracture", setsReps: "3x15", phase: "Early Rehab", description: "Reduces weight-bearing load on the wrist while maintaining chest strength." },
            { id: 11, name: "Hamstring Curls (Banded/Slider)", category: "Strength Training", focus: "Hamstrings", injury: "Hamstring Strain", setsReps: "3x12", phase: "Mid Rehab", description: "Focus on eccentric control. Keep hips stable." },
            { id: 12, name: "Triceps Extension (Band)", category: "Strength Training", focus: "Triceps", injury: "Elbow Tendonitis", setsReps: "3x15", phase: "Early Rehab", description: "Light resistance for tendon loading and strengthening elbow extensors." },
            { id: 13, name: "Supine Chin Tuck with Resistance", category: "Strength Training", focus: "Deep Neck Flexors", injury: "Cervical Sprain", setsReps: "3x10s hold", phase: "Acute/Early Rehab", description: "Strengthening neck stability with light towel resistance." },
            { id: 14, name: "Terminal Knee Extension (TKE)", category: "Strength Training", focus: "VMO", injury: "Patellofemoral Pain", setsReps: "3x20", phase: "Early Rehab", description: "Uses a band around the knee to force contraction of the vastus medialis obliquus." },
            { id: 15, name: "Side Plank (Modified)", category: "Strength Training", focus: "Obliques, Core", injury: "Low Back Instability", setsReps: "3x30s/side", phase: "Mid Rehab", description: "Perform on knees to reduce leverage and build initial side core strength." },
            { id: 16, name: "Quadruped Dumbbell Kickback", category: "Strength Training", focus: "Glutes, Low Back", injury: "Sciatica", setsReps: "3x10/leg", phase: "Mid Rehab", description: "Focus on hip extension without increasing lumbar lordosis." },
            { id: 17, name: "Reverse Fly (Thera-Band)", category: "Strength Training", focus: "Posterior Deltoid", injury: "Shoulder Impingement", setsReps: "3x15", phase: "Mid Rehab", description: "Strengthening antagonist muscles to pull shoulder blades back." },
            { id: 18, name: "Wrist Extension (Light Weight)", category: "Strength Training", focus: "Wrist Extensors", injury: "Lateral Epicondylitis", setsReps: "3x15", phase: "Early Rehab", description: "Slow, controlled movements to load the wrist extensor tendons." },
            { id: 19, name: "Front Foot Elevated Split Squat", category: "Strength Training", focus: "Quads, VMO", injury: "Knee Pain", setsReps: "3x10/leg", phase: "Late Rehab", description: "Increases the demand on the front leg's quad; improves depth." },
            { id: 20, name: "Cable External Rotation (Standing)", category: "Strength Training", focus: "Infraspinatus, Teres Minor", injury: "Rotator Cuff Tear", setsReps: "3x12", phase: "Mid Rehab", description: "Strengthening external rotators for shoulder stability and overhead function." },
            { id: 21, name: "Single-Arm Chest Press (Supine)", category: "Strength Training", focus: "Chest, Core", injury: "Rib Fracture", setsReps: "3x10/arm", phase: "Mid Rehab", description: "Requires core bracing to prevent trunk rotation; use a light dumbbell." },
            { id: 22, name: "Hip Adduction Squeeze (Ball)", category: "Strength Training", focus: "Adductors", injury: "Groin Strain", setsReps: "3x15s hold", phase: "Acute/Early Rehab", description: "Isometric contraction to promote healing and strength in the groin." },
            { id: 23, name: "Wall Slides (Shoulder Flexion)", category: "Strength Training", focus: "Shoulder Flexors", injury: "Frozen Shoulder", setsReps: "3x15", phase: "Early Rehab", description: "Active-assisted range of motion exercise using a frictionless surface." },
            { id: 24, name: "Serratus Punch (Supine)", category: "Strength Training", focus: "Serratus Anterior", injury: "Scapular Winging", setsReps: "3x15", phase: "Mid Rehab", description: "Protracting the shoulder blade against gravity for scapular control." },
            { id: 25, name: "Weighted Carries (Suitcase)", category: "Strength Training", focus: "Lateral Core", injury: "Low Back Stabilization", setsReps: "3x50 steps", phase: "Late Rehab", description: "Anti-lateral flexion drill using a single, heavy weight." },
            { id: 26, name: "Ankle Eversion with Band", category: "Strength Training", focus: "Peroneals", injury: "Ankle Sprain", setsReps: "3x20", phase: "Mid Rehab", description: "Strengthens the primary stabilizers against inversion sprains." },
            { id: 27, name: "Kettlebell Swing (Reduced ROM)", category: "Strength Training", focus: "Hip Hinge, Power", injury: "General Strength", setsReps: "3x10", phase: "Late Rehab/Return to Sport", description: "Focus on hip drive; avoid using the low back." },
            { id: 28, name: "Bicep Curls (Supinated)", category: "Strength Training", focus: "Biceps", injury: "Elbow Fracture", setsReps: "3x12", phase: "Mid Rehab", description: "Controlled flexion with light resistance, monitoring elbow comfort." },
            { id: 29, name: "Psoas March (Supine with Band)", category: "Strength Training", focus: "Hip Flexors, Core", injury: "Hip Flexor Strain", setsReps: "3x20 alternating", phase: "Mid Rehab", description: "Controlled marching motion against light band resistance." },
            { id: 30, name: "Modified Deadlift (Trap Bar)", category: "Strength Training", focus: "Posterior Chain", injury: "Low Back Fusion", setsReps: "3x8", phase: "Advanced Rehab", description: "Allows for a more upright torso position, reducing shear force on the spine." },
            { id: 31, name: "Seated Knee Extension (Unloaded)", category: "Strength Training", focus: "Quadriceps", injury: "Patellofemoral Pain", setsReps: "3x15", phase: "Early Rehab", description: "Focus on full extension and VMO activation without heavy weight." },
            { id: 32, name: "Shoulder External Rotation (Dumbbell)", category: "Strength Training", focus: "Rotator Cuff", injury: "Bicep Tendonitis", setsReps: "3x12", phase: "Mid Rehab", description: "Strengthening the stabilizers with a small dumbbell, elbow tucked." },
            { id: 33, name: "Single-Leg Deadlift (Kettlebell)", category: "Strength Training", focus: "Hamstrings, Balance", injury: "General Strength", setsReps: "3x8/leg", phase: "Late Rehab", description: "Integrates posterior chain strength with unilateral balance." },
            { id: 34, name: "Wall Sits (90-degree)", category: "Strength Training", focus: "Quadriceps", injury: "General Strength", setsReps: "3x60s", phase: "Mid Rehab", description: "Isometric quadriceps endurance building." },
            { id: 35, name: "Resistance Band Chest Press (Standing)", category: "Strength Training", focus: "Pectorals, Shoulders", injury: "Shoulder Instability", setsReps: "3x15", phase: "Mid Rehab", description: "Focus on forward punch motion with stabilization." },
            { id: 36, name: "Copenhagen Adduction (Modified)", category: "Strength Training", focus: "Adductors, Core", injury: "Groin Strain", setsReps: "3x10s hold", phase: "Mid Rehab", description: "Advanced isometric strength for groin and core." },
            { id: 37, name: "Trunk Rotation (Band)", category: "Strength Training", focus: "Obliques, Rotational Core", injury: "Low Back Strain", setsReps: "3x12/side", phase: "Late Rehab", description: "Controlled rotational force with core bracing (Anti-Rotation)." },
            { id: 38, name: "Reverse Lunges (Bodyweight)", category: "Strength Training", focus: "Quads, Glutes", injury: "Knee Osteoarthritis", setsReps: "3x10/leg", phase: "Mid Rehab", description: "Easier on the knee joint than forward lunges; step back smoothly." },
            { id: 39, name: "Trap Raises (Prone)", category: "Strength Training", focus: "Upper Trapezius", injury: "Neck Pain", setsReps: "3x15", phase: "Early Rehab", description: "Shrug motion while lying on stomach." },
            { id: 40, name: "Dumbbell Shrugs (Controlled)", category: "Strength Training", focus: "Upper Trapezius", injury: "General Strength", setsReps: "3x12", phase: "Mid Rehab", description: "Slow, focused elevation and depression of the shoulders." },
            { id: 41, name: "Lateral Arm Raise (Light Weight)", category: "Strength Training", focus: "Deltoids", injury: "Shoulder Impingement", setsReps: "3x15", phase: "Mid Rehab", description: "Controlled abduction, keeping the thumb pointed up." },
            { id: 42, name: "Hollow Body Hold (Modified)", category: "Strength Training", focus: "Global Core", injury: "Low Back Stabilization", setsReps: "3x30s", phase: "Mid Rehab", description: "Keep low back pressed to the floor; bend knees if necessary." },
            { id: 43, name: "Quad Sets (Max Effort)", category: "Strength Training", focus: "Quadriceps", injury: "Post-Op Knee", setsReps: "3x10x10s", phase: "Acute/Early Rehab", description: "Contracting the quad muscle with the knee extended." },
            { id: 44, name: "Ankle Dorsiflexion with Band", category: "Strength Training", focus: "Tibialis Anterior", injury: "Shin Splints", setsReps: "3x20", phase: "Early Rehab", description: "Strengthening the muscle responsible for lifting the foot." },
            { id: 45, name: "Cable Wood Chop (Low to High)", category: "Strength Training", focus: "Rotational Core, Shoulders", injury: "Spinal Stability", setsReps: "3x10/side", phase: "Late Rehab", description: "Power and rotation control exercise." },
            { id: 46, name: "Side-Lying External Rotation (Weight)", category: "Strength Training", focus: "Rotator Cuff", injury: "Shoulder Instability", setsReps: "3x15", phase: "Mid Rehab", description: "Lying on side to isolate the cuff rotators." },
            { id: 47, name: "Mini-Band Squats (Knees Out)", category: "Strength Training", focus: "Glute Medius, Quads", injury: "Knee Valgus", setsReps: "3x15", phase: "Mid Rehab", description: "Use band around knees; focus on pushing knees outward during squat." },
            { id: 48, name: "Seated Hamstring Curl Machine (Light)", category: "Strength Training", focus: "Hamstrings", injury: "General Strength", setsReps: "3x12", phase: "Late Rehab", description: "Gradual introduction of machine resistance." },
            { id: 49, name: "Farmer's Walk (Heavy)", category: "Strength Training", focus: "Grip, Core, Traps", injury: "Neck/Shoulder Stability", setsReps: "3x50m", phase: "Advanced Rehab", description: "Maximal grip endurance and total body stiffness." },
            { id: 50, name: "Single-Arm Overhead Carry", category: "Strength Training", focus: "Shoulder Stability, Core", injury: "Shoulder Impingement", setsReps: "3x25 steps/arm", phase: "Late Rehab", description: "Demanding anti-flexion and shoulder stabilization drill." },

            // STRETCHING/FLEXIBILITY (Orange) - 50 Exercises
            { id: 51, name: "Supine Hamstring Stretch (Strap)", category: "Stretching/Flexibility", focus: "Hamstrings", injury: "Low Back Pain", setsReps: "3x30s", phase: "Early Rehab", description: "Gentle pull to the point of tension; keep knee slightly bent." },
            { id: 52, name: "Pectoralis Major Wall Stretch", category: "Stretching/Flexibility", focus: "Chest", injury: "Shoulder Impingement", setsReps: "3x45s", phase: "Mid Rehab", description: "Hand on wall, rotate body away to feel stretch in the front of the shoulder/chest." },
            { id: 53, name: "Figure-4 Stretch (Supine)", category: "Stretching/Flexibility", focus: "Glutes, Piriformis", injury: "Sciatica", setsReps: "3x30s/side", phase: "Early-Mid Rehab", description: "Relieves pressure on the sciatic nerve by stretching the deep hip rotators." },
            { id: 54, name: "Ankle Dorsiflexion Stretch (Wall)", category: "Stretching/Flexibility", focus: "Ankle Mobility", injury: "Ankle Sprain", setsReps: "3x15s/side", phase: "Mid Rehab", description: "Improves ability to pull the toes up, important for walking and squatting." },
            { id: 55, name: "Cat-Cow (Dynamic Lumbar Mobility)", category: "Stretching/Flexibility", focus: "Spine", injury: "General Stiffness", setsReps: "3x10 reps", phase: "Early Rehab", description: "Gently mobilizing the spine from flexion to extension." },
            { id: 56, name: "Posterior Shoulder Capsule Stretch", category: "Stretching/Flexibility", focus: "Rear Shoulder", injury: "Rotator Cuff Tear", setsReps: "3x20s/arm", phase: "Mid Rehab", description: "Gently pull the elbow across the chest to stretch the back of the shoulder." },
            { id: 57, name: "Seated Calf Stretch (Towel)", category: "Stretching/Flexibility", focus: "Gastrocnemius", injury: "Plantar Fasciitis", setsReps: "3x30s", phase: "Early Rehab", description: "Pull toes towards you with a towel, keeping the knee straight." },
            { id: 58, name: "Quadriceps Stretch (Standing Hold)", category: "Stretching/Flexibility", focus: "Quads, Hip Flexors", injury: "Knee Pain", setsReps: "3x30s/leg", phase: "Mid Rehab", description: "Pull the ankle towards the buttock; use a wall for balance." },
            { id: 59, name: "Cervical Retraction (Chin Tuck)", category: "Stretching/Flexibility", focus: "Neck", injury: "Tension Headache", setsReps: "3x10 reps", phase: "Acute/Early Rehab", description: "Actively pull the head straight back to stretch the suboccipital muscles." },
            { id: 60, name: "Child's Pose (Thoracic Extension)", category: "Stretching/Flexibility", focus: "Thoracic Spine, Lats", injury: "Postural Syndrome", setsReps: "3x60s", phase: "Early Rehab", description: "Long, gentle stretch for the back and lats." },
            { id: 61, name: "Wrist Flexor Stretch (Palm Up)", category: "Stretching/Flexibility", focus: "Forearm", injury: "Medial Epicondylitis", setsReps: "3x30s/arm", phase: "Early Rehab", description: "Gently pull the fingers back with the elbow straight." },
            { id: 62, name: "Couch Stretch (Knee to Wall)", category: "Stretching/Flexibility", focus: "Hip Flexors, Quads", injury: "Anterior Hip Pain", setsReps: "2x60s/leg", phase: "Mid Rehab", description: "Deep stretch for the hip flexors and rectus femoris." },
            { id: 63, name: "Prayer Stretch (Seated)", category: "Stretching/Flexibility", focus: "Lats, Triceps", injury: "Shoulder Stiffness", setsReps: "3x30s", phase: "Mid Rehab", description: "Hands behind the neck, gently push the elbows back." },
            { id: 64, name: "Seated Trunk Rotation", category: "Stretching/Flexibility", focus: "Spine, Obliques", injury: "Low Back Stiffness", setsReps: "3x15s/side", phase: "Early Rehab", description: "Gentle, active rotation of the upper body while seated." },
            { id: 65, name: "Shoulder Pendulum Swings", category: "Stretching/Flexibility", focus: "Shoulder Range of Motion", injury: "Post-Op Shoulder", setsReps: "3x20 reps", phase: "Acute/Early Rehab", description: "Passive motion to prevent stiffness; use gravity to assist." },
            { id: 66, name: "Deep Squat Hold (Assisted)", category: "Stretching/Flexibility", focus: "Ankles, Hips", injury: "General Mobility", setsReps: "3x30s", phase: "Mid Rehab", description: "Hold onto a pole/door frame for support; work into full ankle/hip range." },
            { id: 67, name: "Neck Lateral Flexion Stretch", category: "Stretching/Flexibility", focus: "Upper Trapezius, Neck", injury: "Whiplash", setsReps: "3x30s/side", phase: "Early Rehab", description: "Gently tilt ear toward shoulder; use light hand assist." },
            { id: 68, name: "Standing T-Spine Extension (Chair)", category: "Stretching/Flexibility", focus: "Thoracic Spine", injury: "Postural Syndrome", setsReps: "3x10 reps", phase: "Mid Rehab", description: "Drape torso over the back of a chair to extend the mid-back." },
            { id: 69, name: "Sartorius Stretch (Butterfly)", category: "Stretching/Flexibility", focus: "Inner Thigh, Groin", injury: "Groin Strain", setsReps: "3x45s", phase: "Mid Rehab", description: "Feet together, gently press knees down." },
            { id: 70, name: "Open Book Stretch (Side-Lying)", category: "Stretching/Flexibility", focus: "Thoracic Rotation", injury: "Low Back Pain", setsReps: "3x10/side", phase: "Early-Mid Rehab", description: "Improves mid-back rotation, taking stress off the lower back." },
            { id: 71, name: "Kneeling Hip Flexor Stretch (Psoas)", category: "Stretching/Flexibility", focus: "Hip Flexors", injury: "Anterior Pelvic Tilt", setsReps: "3x45s/leg", phase: "Mid Rehab", description: "Drive the hip forward while tucking the tailbone for a deeper stretch." },
            { id: 72, name: "Wrist Extension Stretch (Palm Down)", category: "Stretching/Flexibility", focus: "Forearm", injury: "Lateral Epicondylitis", setsReps: "3x30s/arm", phase: "Early Rehab", description: "Gently pull the fingers towards the floor with the elbow straight." },
            { id: 73, name: "Thread the Needle (Shoulder/T-Spine)", category: "Stretching/Flexibility", focus: "Thoracic Rotation, Shoulder", injury: "Shoulder/Back Stiffness", setsReps: "3x30s/side", phase: "Mid Rehab", description: "Reach one arm under the other for a deep mid-back twist." },
            { id: 74, name: "IT Band Stretch (Standing Cross-Over)", category: "Stretching/Flexibility", focus: "IT Band, Glutes", injury: "Knee Tracking Issues", setsReps: "3x30s/side", phase: "Mid Rehab", description: "Cross one leg behind the other and lean to the side." },
            { id: 75, name: "Gastrocnemius (Straight Knee) Wall Stretch", category: "Stretching/Flexibility", focus: "Calf, Achilles", injury: "Calf Strain", setsReps: "3x30s/leg", phase: "Early-Mid Rehab", description: "Heel flat on the floor, back leg straight." },
            { id: 76, name: "Soleus (Bent Knee) Wall Stretch", category: "Stretching/Flexibility", focus: "Deep Calf", injury: "Achilles Tendinopathy", setsReps: "3x30s/leg", phase: "Mid Rehab", description: "Heel flat on the floor, back knee bent." },
            { id: 77, name: "Triceps/Lat Stretch (Overhead)", category: "Stretching/Flexibility", focus: "Triceps, Lats", injury: "Shoulder Mobility", setsReps: "3x30s/side", phase: "Mid Rehab", description: "Reach arm overhead, grab elbow with opposite hand and pull gently." },
            { id: 78, name: "Knees-to-Chest (Double)", category: "Stretching/Flexibility", focus: "Low Back, Glutes", injury: "Low Back Strain", setsReps: "3x45s", phase: "Acute/Early Rehab", description: "Relieves compression on the lumbar spine." },
            { id: 79, name: "Rotator Cuff Sleeper Stretch (Side-Lying)", category: "Stretching/Flexibility", focus: "Posterior Shoulder", injury: "Shoulder Impingement", setsReps: "3x30s/side", phase: "Late Rehab", description: "Aggressive internal rotation stretch; use caution." },
            { id: 80, name: "Downward Dog (Modified)", category: "Stretching/Flexibility", focus: "Hamstrings, Calves, Shoulders", injury: "General Mobility", setsReps: "3x60s", phase: "Mid Rehab", description: "Focus on a straight back; pedal the feet to stretch calves alternately." },
            { id: 81, name: "Prone Hip Extension (Leg Hang)", category: "Stretching/Flexibility", focus: "Hip Flexors", injury: "Anterior Hip Pain", setsReps: "3x60s/leg", phase: "Mid Rehab", description: "Lying on a table, let one leg hang off the side to passively stretch the front of the hip." },
            { id: 82, name: "Shoulder Extension with Stick", category: "Stretching/Flexibility", focus: "Anterior Shoulder, Chest", injury: "Post-Op Shoulder", setsReps: "3x10 reps", phase: "Early Rehab", description: "Use a stick to gently push the arms behind the back." },
            { id: 83, name: "Piriformis Stretch (Seated)", category: "Stretching/Flexibility", focus: "Glutes, Piriformis", injury: "Sciatica", setsReps: "3x30s/side", phase: "Early-Mid Rehab", description: "Cross ankle over opposite knee, lean forward for stretch." },
            { id: 84, name: "Dynamic Psoas Rocking", category: "Stretching/Flexibility", focus: "Hip Flexors", injury: "Psoas Tightness", setsReps: "3x15 reps/side", phase: "Mid Rehab", description: "Rock forward and back gently in a kneeling lunge position." },
            { id: 85, name: "Cervical Rotation (Active)", category: "Stretching/Flexibility", focus: "Neck Range of Motion", injury: "Neck Stiffness", setsReps: "3x10/side", phase: "Early Rehab", description: "Slowly turn head to look over each shoulder." },
            { id: 86, name: "Ankle Alphabet", category: "Stretching/Flexibility", focus: "Ankle Mobility", injury: "Ankle Fracture", setsReps: "3xABC", phase: "Acute/Early Rehab", description: "Trace the alphabet with your foot to restore range of motion." },
            { id: 87, name: "Wall Assisted Pec Minor Stretch", category: "Stretching/Flexibility", focus: "Pec Minor", injury: "Upper Cross Syndrome", setsReps: "3x45s", phase: "Mid Rehab", description: "Lean against a corner to stretch the deep chest muscle." },
            { id: 88, name: "Side Bend (Standing)", category: "Stretching/Flexibility", focus: "Quadratus Lumborum (QL)", injury: "Low Back Pain", setsReps: "3x15s/side", phase: "Early Rehab", description: "Reach one arm overhead and gently lean to the opposite side." },
            { id: 89, name: "Lateral Hip Glide (Band)", category: "Stretching/Flexibility", focus: "Hip Joint Capsule", injury: "Hip Osteoarthritis", setsReps: "3x60s/side", phase: "Mid Rehab", description: "Use a band to pull the femur laterally to distract the joint." },
            { id: 90, name: "Dynamic Knee Circles (Supine)", category: "Stretching/Flexibility", focus: "Hip Range of Motion", injury: "Post-Op Hip", setsReps: "3x10/direction", phase: "Early Rehab", description: "Gently circle the bent knee to improve hip joint motion." },
            { id: 91, name: "Self-Mobilization (Foam Roll Thoracic)", category: "Stretching/Flexibility", focus: "Thoracic Spine", injury: "Postural Syndrome", setsReps: "3x10 rolls", phase: "Mid Rehab", description: "Rolling up and down the mid-back on a foam roller to improve extension." },
            { id: 92, name: "Cervical Extension/Flexion (Active)", category: "Stretching/Flexibility", focus: "Neck Range of Motion", injury: "Neck Stiffness", setsReps: "3x10 reps", phase: "Early Rehab", description: "Slowly nod head up and down." },
            { id: 93, name: "Assisted Calf Pump (Stairs)", category: "Stretching/Flexibility", focus: "Calves", injury: "Achilles Tendinopathy", setsReps: "3x15 reps", phase: "Late Rehab", description: "Standing on a step, slowly lower heels to stretch calves." },
            { id: 94, name: "Overhead Bar Hang (Assisted)", category: "Stretching/Flexibility", focus: "Shoulder Decompression", injury: "Shoulder Pain", setsReps: "3x30s", phase: "Mid Rehab", description: "Use minimal grip strength to hang, decompressing the shoulder joint." },
            { id: 95, name: "Reverse Table Top (Dynamic)", category: "Stretching/Flexibility", focus: "Chest, Shoulders, Triceps", injury: "Postural Syndrome", setsReps: "3x10 reps", phase: "Mid Rehab", description: "A dynamic opening of the chest and front of the shoulders." },
            { id: 96, name: "Forearm Rotation (Active)", category: "Stretching/Flexibility", focus: "Forearm", injury: "Elbow Tendonitis", setsReps: "3x15/direction", phase: "Early Rehab", description: "Slow pronation and supination (turning palm up and down)." },
            { id: 97, name: "Posterior Glide Mobilization (Knee)", category: "Stretching/Flexibility", focus: "Knee Joint", injury: "Post-Op Knee", setsReps: "3x10 reps", phase: "Early Rehab", description: "Self-mobilization using a strap to pull the tibia backward." },
            { id: 98, name: "Seated Low Back Flexion (Round Back)", category: "Stretching/Flexibility", focus: "Low Back", injury: "Low Back Stiffness", setsReps: "3x30s", phase: "Early Rehab", description: "Gently round the lower back while seated to relieve pressure." },
            { id: 99, name: "Seated Upper Trap Stretch (Gently)", category: "Stretching/Flexibility", focus: "Upper Trapezius", injury: "Neck Tension", setsReps: "3x30s/side", phase: "Acute/Early Rehab", description: "Sit on your hand, then gently tilt head away." },
            { id: 100, name: "Side-Lying Gluteal Scoops", category: "Stretching/Flexibility", focus: "Hip Mobility", injury: "Hip Stiffness", setsReps: "3x15 reps/side", phase: "Mid Rehab", description: "Small, controlled arc motion of the top leg to mobilize the hip." },

            // BALANCE/COORDINATION (Teal) - 20 Exercises
            { id: 101, name: "Single Leg Stance (Eyes Open)", category: "Balance/Coordination", focus: "Proprioception", injury: "Ankle Sprain", setsReps: "3x60s/leg", phase: "Mid Rehab", description: "Basic single leg balance; use a stable surface." },
            { id: 102, name: "Tandem Stance (Heel to Toe)", category: "Balance/Coordination", focus: "Static Balance", injury: "General Balance", setsReps: "3x60s", phase: "Early-Mid Rehab", description: "Standing with one foot directly in front of the other." },
            { id: 103, name: "Single Leg Stance (Eyes Closed)", category: "Balance/Coordination", focus: "Proprioception", injury: "Concussion", setsReps: "3x30s/leg", phase: "Late Rehab", description: "Removes visual input to increase reliance on joint and muscle feedback." },
            { id: 104, name: "Single Leg Stance (Dynamic Arm Swings)", category: "Balance/Coordination", focus: "Dynamic Balance", injury: "Shoulder/Hip", setsReps: "3x15 swings/leg", phase: "Late Rehab", description: "Adds an upper body movement to challenge core and hip stability." },
            { id: 105, name: "BOSU Ball Single Leg Balance", category: "Balance/Coordination", focus: "Advanced Proprioception", injury: "Ankle Instability", setsReps: "3x45s/leg", phase: "Advanced Rehab", description: "Standing on an unstable surface to maximally challenge stabilizers." },
            { id: 106, name: "Weight Shifting (Standing)", category: "Balance/Coordination", focus: "Hip Strategy", injury: "General Weakness", setsReps: "3x20 reps/side", phase: "Early Rehab", description: "Controlled shift of weight from one leg to the other." },
            { id: 107, name: "Gaze Stabilization (Standing)", category: "Balance/Coordination", focus: "Vestibular System", injury: "Concussion/Vertigo", setsReps: "3x30s", phase: "Early-Mid Rehab", description: "Focus on a fixed point while moving head slowly." },
            { id: 108, name: "Reach to Cones (Single Leg)", category: "Balance/Coordination", focus: "Functional Reach", injury: "Low Back/Hip", setsReps: "3x10 reaches/leg", phase: "Late Rehab", description: "Maintain balance while reaching forward/sideways/diagonally." },
            { id: 109, name: "Tandem Walk (Heel-to-Toe)", category: "Balance/Coordination", focus: "Gait Coordination", injury: "General Balance", setsReps: "3x10 steps", phase: "Mid Rehab", description: "Walking with a narrow base of support; improves dynamic balance." },
            { id: 110, name: "Single Leg Squat (To Chair)", category: "Balance/Coordination", focus: "Unilateral Control", injury: "Knee (ACL)", setsReps: "3x10/leg", phase: "Late Rehab", description: "Deep single-leg stability and strength practice." },
            { id: 111, name: "Foam Pad Single Leg Stance", category: "Balance/Coordination", focus: "Proprioception", injury: "General Balance", setsReps: "3x45s/leg", phase: "Mid Rehab", description: "Increases the difficulty of single leg stance by softening the surface." },
            { id: 112, name: "Star Excursion Balance Test (Modified)", category: "Balance/Coordination", focus: "Dynamic Reach", injury: "Ankle Sprain", setsReps: "3x5 reaches/direction", phase: "Late Rehab", description: "Reaching in multiple directions to challenge the supporting leg." },
            { id: 113, name: "Head Turns in Single Leg Stance (Eyes Open)", category: "Balance/Coordination", focus: "Vestibular Challenge", injury: "Concussion", setsReps: "3x30s", phase: "Mid Rehab", description: "Adds a vestibular component to the balance drill." },
            { id: 114, name: "Ball Toss (Single Leg)", category: "Balance/Coordination", focus: "Cognitive/Motor Integration", injury: "General Stability", setsReps: "3x20 tosses/leg", phase: "Advanced Rehab", description: "Forces attention away from the support leg." },
            { id: 115, name: "Heel Raises (Slow/Controlled)", category: "Balance/Coordination", focus: "Ankle Strategy", injury: "Achilles/Ankle", setsReps: "3x15 reps", phase: "Early Rehab", description: "Slow, focused ankle movements for initial balance strategy." },
            { id: 116, name: "Walking Backward", category: "Balance/Coordination", focus: "Gait Reversal", injury: "General Balance", setsReps: "3x20 steps", phase: "Mid Rehab", description: "Challenges balance in a non-familiar gait pattern." },
            { id: 117, name: "Lateral Hops (Mini)", category: "Balance/Coordination", focus: "Plymoteric/Landing", injury: "Knee/Ankle", setsReps: "3x10 hops/side", phase: "Advanced Rehab", description: "Small, quick side-to-side movements for landing control." },
            { id: 118, name: "Marching in Place (High Knees)", category: "Balance/Coordination", focus: "Dynamic Stability", injury: "General Coordination", setsReps: "3x60s", phase: "Mid Rehab", description: "Alternating single-leg stance quickly." },
            { id: 119, name: "Lunge to Balance (Controlled)", category: "Balance/Coordination", focus: "Stance Transition", injury: "Knee Pain", setsReps: "3x10/leg", phase: "Late Rehab", description: "Moving from a lunge position to a single leg stance." },
            { id: 120, name: "Hip Hike (Standing)", category: "Balance/Coordination", focus: "Hip Stabilizers", injury: "Trendelenburg Gait", setsReps: "3x15 reps/side", phase: "Mid Rehab", description: "Stand on one leg, lift the opposite hip up and down to activate glute medius." },

            // FUNCTIONAL EXERCISE (Indigo/Functional Accent) - 15 Exercises
            { id: 121, name: "Wall Ball Squat (Hold)", category: "Functional Exercise", focus: "Lower Body Endurance", injury: "Knee Pain", setsReps: "3x45s", phase: "Mid Rehab", description: "Use a stability ball against a wall for support; focus on depth and quads." },
            { id: 122, name: "Carry and Walk (Opposite Sides)", category: "Functional Exercise", focus: "Gait Integration", injury: "Low Back Pain", setsReps: "3x50 steps", phase: "Late Rehab", description: "Carry a weight overhead in one hand and a suitcase in the other." },
            { id: 123, name: "Step Down (Forward)", category: "Functional Exercise", focus: "Eccentric Quad", injury: "Patellofemoral Pain", setsReps: "3x10/leg", phase: "Mid Rehab", description: "Slowly lower the foot to the ground/step in front of you." },
            { id: 124, name: "Rowing Machine (Light Resistance)", category: "Functional Exercise", focus: "Cardio, Total Body", injury: "General Conditioning", setsReps: "3x5 minutes", phase: "Mid Rehab", description: "Low impact cardio and full-body strength." },
            { id: 125, name: "Dumbbell Snatch (Light Weight)", category: "Functional Exercise", focus: "Power, Coordination", injury: "Return to Sport", setsReps: "3x8/arm", phase: "Advanced Rehab", description: "An integrated, explosive movement focusing on hip/shoulder synchronization." },
            { id: 126, name: "Farmer's Carry (Light to Moderate)", category: "Functional Exercise", focus: "Grip, Core", injury: "Shoulder/Core Stability", setsReps: "3x60 steps", phase: "Mid Rehab", description: "Carry moderate weight in both hands for core and grip endurance." },
            { id: 127, name: "Overhead Squat (PVC Pipe)", category: "Functional Exercise", focus: "Mobility, Core, Depth", injury: "Shoulder/T-Spine Mobility", setsReps: "3x10", phase: "Late Rehab", description: "Demonstrates integrated full-body mobility and stability." },
            { id: 128, name: "Lateral Bounds (Short Distance)", category: "Functional Exercise", focus: "Lateral Power/Landing", injury: "ACL/Ankle", setsReps: "3x10 bounds/side", phase: "Advanced Rehab", description: "Focus on controlled landing and quick push-off." },
            { id: 129, name: "Walking Lunges (Controlled)", category: "Functional Exercise", focus: "Gait, Strength", injury: "General Strength", setsReps: "3x10/leg", phase: "Late Rehab", description: "Dynamic movement that mimics gait and requires single-leg control." },
            { id: 130, name: "Get-Up/Get-Down Practice (Floor)", category: "Functional Exercise", focus: "Floor to Stand Transition", injury: "General Weakness", setsReps: "3x5 reps", phase: "Mid Rehab", description: "Practicing the ability to safely fall and get back up." },
            { id: 131, name: "Medicine Ball Catch/Throw (Seated)", category: "Functional Exercise", focus: "Rotational Power", injury: "Spine/Core", setsReps: "3x10/side", phase: "Late Rehab", description: "Generates rotational force under control." },
            { id: 132, name: "Box Jumps (Low Box)", category: "Functional Exercise", focus: "Explosive Power", injury: "Return to Sport", setsReps: "3x8", phase: "Advanced Rehab", description: "Low impact plyometric exercise to rebuild power." },
            { id: 133, name: "Shuttle Runs (5-10-5)", category: "Functional Exercise", focus: "Agility/Deceleration", injury: "ACL/Ankle", setsReps: "3x4 reps", phase: "Advanced Rehab", description: "Practice quick changes of direction and deceleration control." },
            { id: 134, name: "Stairs Training (Focus on Single Leg)", category: "Functional Exercise", focus: "Gait Mimicry", injury: "Knee/Hip", setsReps: "3x3 flights", phase: "Mid Rehab", description: "Practicing the functional demand of climbing and descending stairs." },
            { id: 135, name: "Push-Pull Sled Drags (Light)", category: "Functional Exercise", focus: "Total Body Strength/Endurance", injury: "General Conditioning", setsReps: "3x25m pushes/drags", phase: "Advanced Rehab", description: "Low impact, high strength demand exercise." },

            // MOTOR CONTROL (Deep Green) - 15 Exercises
            { id: 136, name: "Core Activation (Transverse Abdominus)", category: "Motor Control", focus: "Deep Core", injury: "Low Back Pain", setsReps: "3x10s hold", phase: "Acute/Early Rehab", description: "Gentle pull of the navel toward the spine without moving the pelvis." },
            { id: 137, name: "Bird-Dog (Slow/Controlled)", category: "Motor Control", focus: "Spine Stability", injury: "Low Back Pain", setsReps: "3x10 alternating", phase: "Early-Mid Rehab", description: "Extend opposite arm and leg while maintaining a neutral spine." },
            { id: 138, name: "Heel Slide (Supine)", category: "Motor Control", focus: "Knee/Hip Control", injury: "Post-Op Knee", setsReps: "3x15", phase: "Acute/Early Rehab", description: "Slowly slide the heel up and down the mat; focus on a smooth, controlled motion." },
            { id: 139, name: "Shoulder External Rotation (No Weight)", category: "Motor Control", focus: "Rotator Cuff Activation", injury: "Shoulder Instability", setsReps: "3x20", phase: "Early Rehab", description: "Active range of motion (AROM) to re-establish the movement pattern." },
            { id: 140, name: "Glute Activation (Side-Lying Hold)", category: "Motor Control", focus: "Glute Medius", injury: "Hip Weakness", setsReps: "3x10s hold", phase: "Early Rehab", description: "Lie on your side, lift the top leg slightly, and hold the contraction." },
            { id: 141, name: "Diaphragmatic Breathing (Supine)", category: "Motor Control", focus: "Breathing/Core", injury: "Rib Pain, Stress", setsReps: "5x1 minute", phase: "Acute/Early Rehab", description: "Focus on breathing into the belly, not the chest, to engage core stabilizers." },
            { id: 142, name: "Standing T-Spine Rotation (Controlled)", category: "Motor Control", focus: "Thoracic Mobility", injury: "Postural Syndrome", setsReps: "3x12/side", phase: "Mid Rehab", description: "Rotation of the upper body with core control, isolating movement from the lumbar spine." },
            { id: 143, name: "Single Leg Stance (Tactile Cueing)", category: "Motor Control", focus: "Proprioception", injury: "Ankle Sprain", setsReps: "3x45s/leg", phase: "Mid Rehab", description: "Use finger touch on a wall/chair to facilitate balance without relying on it." },
            { id: 144, name: "Pelvic Clock (Supine)", category: "Motor Control", focus: "Pelvic Mobility/Control", injury: "Low Back/SIJ", setsReps: "3x10 full circles", phase: "Early Rehab", description: "Gently tilt the pelvis in a circular pattern, imagining a clock face." },
            { id: 145, name: "Wrist Cocking (Controlled)", category: "Motor Control", focus: "Wrist Extensors/Flexors", injury: "Tendonitis", setsReps: "3x15", phase: "Early Rehab", description: "Slow, deliberate movement of the wrist up and down." },
            { id: 146, name: "Shoulder Blade Retraction (Active)", category: "Motor Control", focus: "Scapular Control", injury: "Postural Syndrome", setsReps: "3x15", phase: "Early Rehab", description: "Actively pinch the shoulder blades together and hold." },
            { id: 147, name: "Supine Glute Squeeze", category: "Motor Control", focus: "Gluteus Maximus", injury: "Gluteal Amnesia", setsReps: "3x10s hold", phase: "Acute/Early Rehab", description: "Maximal voluntary contraction of the glutes while lying on the back." },
            { id: 148, name: "Toe Spreads/Crunches", category: "Motor Control", focus: "Foot Intrinsic Muscles", injury: "Plantar Fasciitis", setsReps: "3x15", phase: "Early Rehab", description: "Actively spread toes apart and then crunch them under." },
            { id: 149, name: "Nerve Glides (Sciatic/Median)", category: "Motor Control", focus: "Nervous System Mobility", injury: "Nerve Impingement", setsReps: "3x10 reps/side", phase: "Mid Rehab", description: "Controlled movement to promote nerve flossing." },
            { id: 150, name: "Prone Hip Extension (Small Range)", category: "Motor Control", focus: "Glute Max Activation", injury: "Low Back Pain", setsReps: "3x15", phase: "Early-Mid Rehab", description: "Lying on stomach, lift leg 1-2 inches using glute, not low back." }
        ];

        // --- GLOBAL VARIABLES (for shared state) ---
        let currentExercises = exercises; // The currently filtered/searched list
        
        // --- UTILITY & VIEW FUNCTIONS ---
        
        /**
         * Renders the exercise cards into the results container based on the current search/filter.
         * @param {Array<Object>} exerciseList - The array of exercises to display.
         */
        function renderExerciseLibrary(exerciseList = exercises) {
            const container = document.getElementById('resultsContainer');
            const countSpan = document.getElementById('exerciseCount');
            container.innerHTML = ''; // Clear previous results

            if (exerciseList.length === 0) {
                document.getElementById('noResults').classList.remove('hidden');
                countSpan.textContent = '0';
                return;
            }

            document.getElementById('noResults').classList.add('hidden');
            countSpan.textContent = exerciseList.length;

            exerciseList.forEach(exercise => {
                // Map category to CSS border class
                let borderClass = '';
                switch(exercise.category) {
                    case 'Strength Training': borderClass = 'strength-border'; break;
                    case 'Stretching/Flexibility': borderClass = 'stretching-border'; break;
                    case 'Balance/Coordination': borderClass = 'balance-border'; break;
                    case 'Functional Exercise': borderClass = 'functional-border'; break;
                    case 'Motor Control': borderClass = 'motor-control-border'; break;
                    default: borderClass = 'border-gray-500';
                }

                const card = document.createElement('div');
                card.className = `card bg-gray-700 p-4 rounded-xl shadow-lg hover:shadow-2xl transition-all ${borderClass}`;
                card.setAttribute('draggable', 'true');
                card.setAttribute('ondragstart', `handleDragStart(event, ${exercise.id})`);
                
                // Use a data attribute to store the full exercise object for easier drop handling
                card.dataset.exercise = JSON.stringify(exercise); 

                card.innerHTML = `
                    <h4 class="text-xl font-bold text-teal-300 mb-1">${exercise.name}</h4>
                    <p class="text-sm font-semibold text-gray-400 mb-2">${exercise.category} | Phase: ${exercise.phase}</p>
                    <p class="text-gray-200 mb-2">${exercise.setsReps}</p>
                    <p class="text-gray-400 text-sm">${exercise.description}</p>
                    <div class="mt-2 text-xs font-medium text-gray-500">Focus: ${exercise.focus} | Injury: ${exercise.injury}</div>
                `;

                container.appendChild(card);
            });
        }
        
        /**
         * Filters the exercises based on the search input.
         */
        function searchExercises() {
            const searchInput = document.getElementById('searchInput');
            const searchTerm = searchInput.value.toLowerCase().trim();

            if (searchTerm === '') {
                currentExercises = exercises;
            } else {
                currentExercises = exercises.filter(exercise => 
                    exercise.name.toLowerCase().includes(searchTerm) ||
                    exercise.category.toLowerCase().includes(searchTerm) ||
                    exercise.focus.toLowerCase().includes(searchTerm) ||
                    exercise.injury.toLowerCase().includes(searchTerm) ||
                    exercise.phase.toLowerCase().includes(searchTerm) ||
                    exercise.description.toLowerCase().includes(searchTerm)
                );
            }
            renderExerciseLibrary(currentExercises);
        }

        // Attach search handler
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('searchInput').addEventListener('input', searchExercises);
        });
        
        // --- DRAG-AND-DROP FUNCTIONS ---
        
        /**
         * Initiates the drag operation, storing the exercise data.
         * The ID is enough, but storing the whole JSON is more robust.
         */
        window.handleDragStart = function(event, exerciseId) {
            const exerciseData = event.target.dataset.exercise;
            event.dataTransfer.setData('text/plain', exerciseData);
            
            // Add a class to the original element to give a visual cue (optional)
            event.target.classList.add('opacity-50');
        };

        /**
         * Handles the drag over event on the HEP Pad.
         */
        window.handleDragOver = function(event) {
            event.preventDefault(); // Essential to allow a drop
            const hepPad = document.getElementById('hepPad');
            hepPad.classList.add('drag-over');
        };

        /**
         * Handles the drag leave event on the HEP Pad.
         */
        window.handleDragLeave = function(event) {
            const hepPad = document.getElementById('hepPad');
            // Check if the cursor is truly leaving the drop zone area
            // This is a common bug fix for nested elements
            if (!hepPad.contains(event.relatedTarget)) {
                hepPad.classList.remove('drag-over');
            }
        };

        /**
         * Handles the drop event on the HEP Pad.
         */
        window.handleDrop = function(event) {
            event.preventDefault();
            const hepPad = document.getElementById('hepPad');
            hepPad.classList.remove('drag-over');

            try {
                const exerciseJson = event.dataTransfer.getData('text/plain');
                const exercise = JSON.parse(exerciseJson);
                
                // Add to the selected list if not already present (optional check)
                if (!window.selectedExercises.some(e => e.id === exercise.id)) {
                    // Create a clean copy to allow modification (e.g., sets/reps change)
                    const prescribedExercise = {...exercise, setsReps: exercise.setsReps};
                    window.selectedExercises.push(prescribedExercise);
                    window.renderHEPPad();
                    showMessage("Exercise Added", `**${exercise.name}** has been added to the prescription pad.`);
                } else {
                    showMessage("Already Added", `**${exercise.name}** is already in the prescription pad.`);
                }

            } catch (e) {
                console.error("Error parsing exercise data:", e);
                showMessage("Drop Error", "Could not add exercise. Data format incorrect.");
            }
        };
        
        /**
         * Removes an exercise from the prescription pad.
         */
        window.removeExercise = function(exerciseId) {
            window.selectedExercises = window.selectedExercises.filter(e => e.id !== exerciseId);
            window.renderHEPPad();
            showMessage("Removed", "Exercise removed from the current program.");
        };

        /**
         * Renders the exercises currently in the Prescription Pad.
         */
        window.renderHEPPad = function() {
            const container = document.getElementById('hepPadContent');
            const emptyMsg = document.getElementById('hepPadEmptyMessage');
            const button = document.getElementById('prescribeButton');
            container.innerHTML = '';
            
            if (window.selectedExercises.length === 0) {
                emptyMsg.classList.remove('hidden');
                button.disabled = true;
                button.textContent = 'Generate and Save HEP (0 Exercises)';
                return;
            }

            emptyMsg.classList.add('hidden');
            button.disabled = false;
            button.textContent = `Generate and Save HEP (${window.selectedExercises.length} Exercises)`;

            window.selectedExercises.forEach(exercise => {
                let borderClass = '';
                switch(exercise.category) {
                    case 'Strength Training': borderClass = 'strength-border'; break;
                    case 'Stretching/Flexibility': borderClass = 'stretching-border'; break;
                    case 'Balance/Coordination': borderClass = 'balance-border'; break;
                    case 'Functional Exercise': borderClass = 'functional-border'; break;
                    case 'Motor Control': borderClass = 'motor-control-border'; break;
                    default: borderClass = 'border-gray-500';
                }
                
                const prescribedCard = document.createElement('div');
                prescribedCard.className = `bg-gray-700 p-3 rounded-lg shadow-md ${borderClass} relative`;
                prescribedCard.innerHTML = `
                    <h5 class="text-lg font-bold text-teal-300">${exercise.name}</h5>
                    <p class="text-sm text-gray-400 mb-2">${exercise.category} | ${exercise.setsReps}</p>
                    <textarea id="notes-${exercise.id}" class="w-full h-12 p-1 text-sm bg-gray-600 text-gray-200 rounded resize-none placeholder-gray-400 focus:ring-2 focus:ring-orange-500" placeholder="Custom sets/reps or notes...">${exercise.customNotes || ''}</textarea>
                    <button onclick="removeExercise(${exercise.id})" class="absolute top-2 right-2 text-red-500 hover:text-red-600 transition-colors" title="Remove Exercise">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
                    </button>
                `;
                
                container.appendChild(prescribedCard);
                
                // Add event listener to save custom notes immediately
                const notesArea = document.getElementById(`notes-${exercise.id}`);
                notesArea.addEventListener('input', (e) => {
                    const index = window.selectedExercises.findIndex(e => e.id === exercise.id);
                    if (index !== -1) {
                        window.selectedExercises[index].customNotes = e.target.value;
                    }
                });
            });
        };

        // --- PROGRAM SAVING AND LOADING FUNCTIONS ---
        
        /**
         * Loads programs from LocalStorage.
         */
        function loadPrograms() {
            try {
                const data = localStorage.getItem(LOCAL_STORAGE_KEY);
                patientPrograms = data ? JSON.parse(data) : [];
                
                // Ensure programs are sorted by timestamp (newest first)
                patientPrograms.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
                
                renderProgramsList();
            } catch (e) {
                console.error("Error loading programs from LocalStorage:", e);
                showMessage("Error", "Failed to load saved programs. Local Storage might be full or blocked.");
            }
        }
        
        /**
         * Saves the current programs array back to LocalStorage.
         */
        function saveProgramsToLocalStorage() {
            try {
                localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(patientPrograms));
            } catch (e) {
                console.error("Error saving programs to LocalStorage:", e);
                showMessage("Error", "Failed to save program. Local Storage might be full or blocked.");
            }
        }
        
        /**
         * Prompts for patient name and saves the current HEP Pad exercises as a new patient program.
         */
        window.saveProgram = function () {
            if (window.selectedExercises.length === 0) {
                showMessage("Error", "The Prescription Pad is empty. Please drag exercises first.");
                return;
            }
            
            const patientName = prompt("Enter Patient Name for this HEP:");
            if (!patientName || patientName.trim() === "") {
                showMessage("Cancelled", "Program save cancelled. No patient name provided.");
                return;
            }
            
            // Map the selected exercises to a simplified structure for storage
            const exercisesToSave = window.selectedExercises.map(ex => ({
                id: ex.id,
                name: ex.name,
                category: ex.category,
                setsReps: ex.setsReps,
                customNotes: ex.customNotes || '', // Store custom notes
                phase: ex.phase,
                description: ex.description // Store full description for viewing
            }));

            const newProgram = {
                id: Date.now().toString(), // Use timestamp as a unique ID
                patientName: patientName.trim(),
                exercises: exercisesToSave,
                timestamp: Date.now() // Current time in milliseconds
            };

            patientPrograms.push(newProgram);
            saveProgramsToLocalStorage(); // Save the updated list

            showMessage("Success", `Program saved successfully for patient: **${patientName.trim()}**`);
            
            // Clear the pad after saving
            window.selectedExercises = []; 
            window.renderHEPPad();
            renderProgramsList(); // Update the saved programs view
        }
        
        /**
         * Renders the list of saved programs.
         */
        function renderProgramsList() {
            const listContainer = document.getElementById('programsList');
            const emptyMsg = document.getElementById('programsEmpty');
            listContainer.innerHTML = '';
            
            if (patientPrograms.length === 0) {
                emptyMsg.classList.remove('hidden');
                return;
            }
            
            emptyMsg.classList.add('hidden');

            patientPrograms.forEach(program => {
                const date = new Date(program.timestamp).toLocaleDateString();
                const time = new Date(program.timestamp).toLocaleTimeString();
                
                const card = document.createElement('div');
                card.className = `bg-gray-900 p-4 rounded-xl shadow-lg border-l-8 border-orange-500 flex justify-between items-center transition-shadow hover:shadow-2xl`;
                card.innerHTML = `
                    <div class="flex-grow">
                        <h4 class="text-xl font-bold text-orange-400">${program.patientName}</h4>
                        <p class="text-sm text-gray-400 mt-1">
                            ${program.exercises.length} Exercises prescribed on ${date} at ${time}
                        </p>
                    </div>
                    <div class="flex space-x-3 ml-4">
                        <button onclick="viewProgramDetail('${program.id}')" class="p-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors" title="View Details">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                        </button>
                        <button onclick="deleteProgram('${program.id}')" class="p-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors" title="Delete Program">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                        </button>
                    </div>
                `;
                listContainer.appendChild(card);
            });
        }
        
        /**
         * Displays the details of a saved program in a modal.
         */
        window.viewProgramDetail = function(programId) {
            const program = patientPrograms.find(p => p.id === programId);
            if (!program) {
                showMessage("Error", "Program not found.");
                return;
            }

            const detailModal = document.getElementById('detailModal');
            const patientName = document.getElementById('detailPatientName');
            const exercisesContainer = document.getElementById('detailProgramExercises');

            patientName.textContent = `HEP for: ${program.patientName}`;
            exercisesContainer.innerHTML = '';

            program.exercises.forEach(ex => {
                let borderClass = '';
                switch(ex.category) {
                    case 'Strength Training': borderClass = 'strength-border'; break;
                    case 'Stretching/Flexibility': borderClass = 'stretching-border'; break;
                    case 'Balance/Coordination': borderClass = 'balance-border'; break;
                    case 'Functional Exercise': borderClass = 'functional-border'; break;
                    case 'Motor Control': borderClass = 'motor-control-border'; break;
                    default: borderClass = 'border-gray-500';
                }

                const detailCard = document.createElement('div');
                detailCard.className = `bg-gray-700 p-4 rounded-lg shadow-md ${borderClass}`;
                detailCard.innerHTML = `
                    <h5 class="text-xl font-bold text-teal-300">${ex.name}</h5>
                    <p class="text-base text-gray-400">${ex.category} | **Prescription:** ${ex.customNotes || ex.setsReps}</p>
                    <p class="text-sm text-gray-300 mt-2">${ex.description}</p>
                `;
                exercisesContainer.appendChild(detailCard);
            });

            detailModal.classList.remove('hidden');
        };
        
        // --- MODAL & UI CONTROL FUNCTIONS ---
        
        /**
         * Generic function to display a message modal.
         */
        function showMessage(title, body) {
            document.getElementById('messageTitle').innerHTML = title;
            document.getElementById('messageBody').innerHTML = body;
            document.getElementById('messageBox').classList.remove('hidden');
        }

        /**
         * Switches the view between Exercise Library and Saved Programs.
         */
        function switchView(viewName) {
            const libraryView = document.getElementById('libraryView');
            const programsView = document.getElementById('programsView');
            const libraryBtn = document.getElementById('viewLibraryBtn');
            const programsBtn = document.getElementById('viewProgramsBtn');

            if (viewName === 'programs') {
                libraryView.classList.add('hidden');
                programsView.classList.remove('hidden');
                
                libraryBtn.classList.remove('bg-teal-600', 'text-white');
                libraryBtn.classList.add('text-gray-300', 'hover:bg-blue-700');
                
                programsBtn.classList.add('bg-orange-600', 'text-white');
                programsBtn.classList.remove('text-gray-300', 'hover:bg-blue-700');
                
                loadPrograms(); // Ensure programs list is fresh
            } else {
                programsView.classList.add('hidden');
                libraryView.classList.remove('hidden');
                
                programsBtn.classList.remove('bg-orange-600', 'text-white');
                programsBtn.classList.add('text-gray-300', 'hover:bg-blue-700');
                
                libraryBtn.classList.add('bg-teal-600', 'text-white');
                libraryBtn.classList.remove('text-gray-300', 'hover:bg-blue-700');
                
                renderExerciseLibrary(currentExercises); // Re-render library
            }
        }
        
        /**
         * Deletes a program from LocalStorage.
         */
        window.deleteProgram = function (programId) {
            const confirmation = prompt(`Type 'DELETE' to confirm removing this program forever:`);
            if (confirmation !== 'DELETE') {
                showMessage("Cancelled", "Program deletion cancelled.");
                return;
            }

            const initialLength = patientPrograms.length;
            patientPrograms = patientPrograms.filter(p => p.id !== programId);

            if (patientPrograms.length < initialLength) {
                saveProgramsToLocalStorage(); // Save the new, filtered list
                showMessage("Deleted", "Program successfully deleted.");
                renderProgramsList(); // Re-render the list
            } else {
                showMessage("Error", "Failed to find program to delete.");
            }
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            // Initial render of the exercise library
            renderExerciseLibrary();
            renderHEPPad(); // Render the empty pad

            // Attach event listeners for modals and buttons
            document.getElementById('messageCloseBtn').addEventListener('click', () => {
                document.getElementById('messageBox').classList.add('hidden');
            });

            document.getElementById('detailCloseBtn').addEventListener('click', () => {
                document.getElementById('detailModal').classList.add('hidden');
            });
            
            // Attach event listener for the Generate/Save button
            document.getElementById('prescribeButton').addEventListener('click', window.saveProgram);
            
            // Attach event listeners for view switching
            document.getElementById('viewLibraryBtn').addEventListener('click', () => switchView('library'));
            document.getElementById('viewProgramsBtn').addEventListener('click', () => switchView('programs'));
            
            // Scroll button for mobile/large library views
            document.getElementById('jumpToBottom').addEventListener('click', () => {
                window.scrollTo({
                    top: document.body.scrollHeight,
                    behavior: 'smooth'
                });
            });
        });
        
    </script>

</body>
</html>